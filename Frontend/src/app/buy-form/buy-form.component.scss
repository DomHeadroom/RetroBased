.window {
  font: var(--font);
  box-shadow: 2px 2px 10px 1px var(--window-border-color), inset 0 0 0 1px #fffa;
  border: var(--window-border) var(--window-border-color);
  border-radius: var(--window-border-radius);
  position: relative;
  z-index: 0;

  &::before {
    content: "";
    position: absolute;
    z-index: -1;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    border-radius: var(--window-border-radius);
    background: linear-gradient(transparent 20%, #ffffffb3 40%, transparent 41%),
      var(--window-background);
    background-color: var(--window-background-color);
    box-shadow: inset 0 0 0 1px #fffd;
  }

  &-body {
    margin: var(--window-spacing);
    margin-top: 0;
    border: var(--window-border) var(--window-border-color);
    background: var(--surface);
    box-shadow: 0 0 0 1px #fff9;

    &.has-space {
      padding: var(--window-spacing);
    }

    pre {
      margin: calc(var(--window-spacing) * -1);
    }
  }

  &-footer,
  footer {
    margin: var(--window-spacing);
    margin-top: calc(-1 * var(--window-spacing) - 1px);
    background: var(--surface);
    border: var(--window-border) var(--window-border-color);
    border-top: 0;
    box-shadow: 0 0.5px 1px 0.5px #fff;
    position: relative;
    padding: 10px;

    &::before {
      content: "";
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 2px;
      box-shadow: inset 0 1px #0000004d, inset 0 -1px #fff;
    }
  }

  &.is-bright {
    .window-body {
      background: #fff;
    }

    .window-footer,
    footer {
      background: #eee;
      box-shadow: inset 0 1px 3px #ddd, 0 1px 0 #fff9, 1px 1px 0 #fff9,
        -1px 1px 0 #fff9;

      &::before {
        content: none;
      }
    }
  }

  &.glass {
    &::before {
      opacity: 0.6;
    }

    &::after {
      content: "";
      position: absolute;
      z-index: -10;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      border-radius: var(--window-border-radius);
      border: none;
      backdrop-filter: blur(4px);
    }

    > .title-bar {
      background: var(--window-background-glass-stripes);
    }
  }

  > .title-bar {
    border: 0;
    box-shadow: inset 0 1px 0 #fffd, inset 1px 0 0 #fffd, inset -1px 0 0 #fffd;
  }

  fieldset {
    margin-bottom: 9px;
  }

  &[role="dialog"] {
    position: fixed;
    z-index: 999;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    visibility: hidden;
    opacity: 0;
    transition-duration: 0.2s;
    transition-property: visibility, opacity;

    &:target {
      visibility: visible;
      opacity: 1;
    }
  }
}

.title-bar {
  font: var(--font);
  box-shadow: inset 0 0 0 1px #fff9;
  border: var(--window-border) var(--window-border-color);
  border-radius: var(--window-border-radius) var(--window-border-radius) 0 0;
  padding: var(--window-spacing);
  padding-top: 0;
  display: flex;
  justify-content: space-between;
  align-items: center;
  background: var(--window-background);
  background-color: var(--window-background-color);

  &-text {
    color: #000;
    letter-spacing: 0;
    line-height: 15px;
    padding-top: var(--window-spacing);
    text-shadow: 0 0 10px #fff, 0 0 10px #fff, 0 0 10px #fff, 0 0 10px #fff,
      0 0 10px #fff, 0 0 10px #fff, 0 0 10px #fff, 0 0 10px #fff;
  }

  &-controls {
    display: flex;
    background: #fff3;
    border: var(--window-border) var(--control-border-color);
    border-top: 0;
    border-radius: 0 0 var(--control-border-radius) var(--control-border-radius);
    box-shadow: 0 1px 0 #fffa, 1px 0 0 #fffa, -1px 0 0 #fffa;

    button {
      position: relative;
      min-width: 29px;
      min-height: 19px;
      padding: 0;
      border: 0;
      border-right: var(--window-border) var(--control-border-color);
      border-radius: 0;
      box-shadow: none;
      box-sizing: border-box;
      background: none;

      &::after {
        content: none;
      }

      &:hover,
      &:active {
        background: none;
      }

      &:disabled {
        &::before {
          opacity: 0.4;
        }
      }

      &::before {
        content: "";
        position: absolute;
        top: 0;
        bottom: 0;
        left: 0;
        right: 0;
        border-radius: 0;
        box-shadow: inset 0 0 0 1px #fff5;
        opacity: 1;
      }

      &:not(:hover)::before {
        transition: none;
        opacity: 1;
      }

      &[aria-label="Close"],
      &.is-close {
        min-width: 48px;

        &::before {
          background: url("/assets/buy-form/images/close-button.png") no-repeat
            center;
        }
      }

      &:first-child,
      &:first-child::before {
        border-bottom-left-radius: var(--control-border-radius);
      }

      &:last-child,
      &:last-child::before {
        border: 0;
        border-bottom-right-radius: var(--control-border-radius);
      }

      &:focus {
        outline: none;
        animation: none;
      }
    }
  }

  .window.active &,
  &.active {
    .title-bar-controls {
      border-color: var(--window-border-color);

      button {
        border-color: var(--window-border-color);
        box-shadow: var(--control-inset-shadow);

        &::after {
          content: none;
        }

        &[aria-label="Close"],
        &.is-close {
          background: url("/assets/buy-form/images/close-button.png") no-repeat
              center,
            var(--control-background), var(--control-background-close);
          box-shadow: var(--control-inset-shadow);

          &::before {
            content: "";
            background: url("/assets/buy-form/images/close-button.png")
                no-repeat center,
              var(--control-background), var(--control-background-close-hovered);
            box-shadow: 0 0 7px 3px #e68e75, var(--control-inset-shadow);
            border-bottom-right-radius: var(--control-border-radius);
            opacity: 0;
            transition: opacity 0.3s linear;
          }

          &:hover::before,
          &:focus-visible::before {
            opacity: 1;
            transition: opacity 0.1s linear;
          }

          &:active::before {
            background: url("/assets/buy-form/images/close-button.png")
                no-repeat center,
              var(--control-background), var(--control-background-close-active);
          }
        }
      }
    }
  }
}

.status-bar {
  margin: var(--window-spacing);
  margin-top: calc(var(--window-spacing) * -1);
  background: var(--surface);
  border: var(--window-border) var(--window-border-color);
  border-top: 0;
  box-shadow: 0 1px 0 #fff9, 1px 0 0 #fff9, -1px 0 0 #fff9;
  display: flex;

  &-field {
    border-right: var(--window-border) #cfcfcf;
    padding: 2px 3px;
    margin: 0;
    flex-grow: 1;

    &:last-child {
      border-right: 0;
    }
  }
}

[role="tabpanel"] {
  position: relative;
  z-index: 2;
}

menu[role="tablist"] {
  position: relative;
  margin: 0 0 -2px 0;
  text-indent: 0;
  list-style-type: none;
  display: flex;
  padding-left: 3px;

  button {
    padding: 2px 6px;
    border-radius: 0;
    z-index: 1;
    display: block;
    color: #222;
    text-decoration: none;
    min-width: unset;

    &[aria-selected="true"] {
      padding-bottom: 4px;
      margin: -2px 0px 1px -3px;
      background: var(--tab-bg);
      box-shadow: none;
      border-bottom: 0;
      position: relative;
      z-index: 8;

      &::before,
      &::after {
        content: none;
      }

      &:hover {
        border-color: var(--tab-border-color);
      }

      &:focus,
      &:active,
      &.active {
        border-color: var(--tab-border-color);
        animation: none;
      }

      &:focus-visible {
        outline: 1px dotted #222;
        outline-offset: -4px;
      }
    }

    &::before {
      border-radius: 0;
    }

    &::after {
      content: none;
    }

    &:disabled {
      opacity: 0.6;
    }
  }

  &.justified {
    button {
      flex-grow: 1;
      text-align: center;
    }
  }
}

[role="tabpanel"] {
  padding: 14px;
  clear: both;
  background: var(--tab-bg);
  border: var(--tab-border);
  position: relative;
  z-index: 2;
  margin-bottom: 9px;
}

select:not([multiple]) {
  font: var(--font);
  padding: 2px 3px;
  border: var(--button-border);
  border-color: var(--button-border-color);
  border-radius: var(--border-radius);
  box-shadow: var(--button-shadow);
  box-sizing: border-box;
  color: #222;
  -webkit-appearance: none;
  -moz-appearance: none;
  appearance: none;
  position: relative;
  padding-right: 30px;
  background: url("/assets/buy-form/svgs/button-down.svg"),
    var(--button-gradient);
  background-position: center right;
  background-repeat: no-repeat;

  &:hover {
    border-color: var(--button-border-color-hovered);
    background-image: url("/assets/buy-form/svgs/button-down.svg"),
      var(--button-gradient-hovered);
  }

  &:active {
    outline: none;
    border-color: var(--button-border-color-active);
    box-shadow: var(--button-shadow-active);
    background-image: url("/assets/buy-form/svgs/button-down.svg"),
      var(--button-gradient-active);
  }

  &:focus {
    outline: 1px dotted #000;
    outline-offset: -4px;
    box-shadow: inset 0 0 0 2px var(--button-shade-light-active);
  }
}

button,
[role="button"] {
  font: var(--font);
  box-sizing: border-box;
  border: var(--button-border);
  border-color: var(--button-border-color);
  border-radius: var(--border-radius);
  box-shadow: var(--button-shadow);
  color: #222;
  min-width: 75px;
  min-height: 23px;
  padding: 0 12px;
  text-align: center;
  background: var(--button-gradient);
  position: relative;
  z-index: 0;

  /* Button style on hovered */
  &::before {
    content: "";
    position: absolute;
    width: 100%;
    height: 100%;
    padding: 0;
    margin: 0;
    top: 0;
    left: 0;
    border-radius: var(--border-radius);
    box-shadow: var(--button-shadow);
    background: var(--button-gradient-hovered);
    opacity: 0;
    transition: opacity 0.3s;
    z-index: -1;
  }

  /* Button style on clicked */
  &::after {
    content: "";
    position: absolute;
    width: 100%;
    height: 100%;
    padding: 0;
    margin: 0;
    top: 0;
    left: 0;
    box-shadow: var(--button-shadow-active);
    border-radius: 2px;
    background: var(--button-gradient-active);
    opacity: 0;
    transition: opacity 0.3s;
    z-index: -1;
  }

  &:disabled {
    background: var(--button-face-disabled);
    border-color: var(--button-border-color-disabled);
    color: var(--button-text-color-disabled);
  }

  &:not(:disabled) {
    /* Animation when hovered */
    &:hover {
      border-color: var(--button-border-color-hovered);
      transition: border-color 0.3s;

      &::before {
        opacity: 1;
        transition: opacity 0.3s;
      }
    }

    /* Animation when unhovered */
    &:not(:hover) {
      border-color: var(--button-border-color);
      transition: border-color 1s linear;

      &::before {
        opacity: 0;
        transition: opacity 1s linear;
      }
    }

    &:active,
    &.active {
      border-color: var(--button-border-color-active);
      transition: border-color 0.3s;

      &::after {
        opacity: 1;
        transition: opacity 0.3s;
      }
    }
  }

  &:focus-visible,
  &.focused {
    box-shadow: inset 0 0 0 2px var(--button-shade-light-active);
    outline: 1px dotted #000;
    outline-offset: -4px;
  }

  &.default,
  &:focus,
  &.focused {
    border-color: var(--button-border-color-default);
    background-image: var(--button-gradient-hovered);
    animation: 1s ease infinite alternate pulse-anim;
  }
}

@keyframes pulse-anim {
  from {
    box-shadow: inset 0 0 3px 1px #34deffdd;
  }
  to {
    box-shadow: inset 0 0 1px 1px #34deffdd;
  }
}

fieldset {
  border: 1px solid #cdd7db;
  border-radius: var(--border-radius);
  box-shadow: inset 0 0 0 1px #fff;
  padding: calc(2 * var(--border-width) + var(--element-spacing));
  padding-block-start: var(--element-spacing);
  margin: 0;

  legend {
    font: var(--font);
  }
}

.field-row {
  display: flex;
  align-items: center;

  > * {
    + * {
      margin-left: var(--grouped-element-spacing);
    }
  }

  &-stacked {
    display: flex;
    flex-direction: column;

    * {
      + * {
        margin-top: var(--grouped-element-spacing);
      }
    }
  }
}

[class^="field-row"] {
  + [class^="field-row"] {
    margin-top: var(--grouped-element-spacing);
  }
}

input[type="radio"] {
  appearance: none;
  -webkit-appearance: none;
  -moz-appearance: none;
  margin: 0;
  background: 0;
  position: fixed;
  opacity: 0;
  border: none;

  + label {
    font: var(--font);
    display: inline-flex;
    align-items: center;
    position: relative;
    margin-left: var(--radio-total-width);

    &::before {
      content: "";
      position: absolute;
      top: 0;
      left: calc(var(--radio-total-width) * -1);
      display: inline-block;
      width: var(--radio-width);
      height: var(--radio-width);
      margin-right: var(--radio-label-spacing);
      background: #f6f6f6;
      border-radius: 50%;
      border: 1px solid;
      border-color: var(--button-border-color);
      box-shadow: inset 0 0 0 1.5px #f4f4f4, inset 1px 1px 0 1.5px #aeaeae,
        inset -1px 0 0 1.5px #ddd, inset 3px 3px 6px #ccc;
      box-sizing: border-box;
      transition: 0.4s;
    }

    &:hover::before {
      border-color: var(--button-border-color-hovered);
      box-shadow: inset 0 0 0 1.5px #def9fa, inset 1px 1px 0 1.5px #79c6f9,
        inset -1px -1px 0 1.5px #c6e9fc, inset 3px 3px 6px #b1dffd;
    }
  }

  &:checked {
    + label {
      &::after {
        content: "";
        display: block;
        width: var(--radio-dot-width);
        height: var(--radio-dot-width);
        top: var(--radio-dot-top);
        left: var(--radio-dot-left);
        position: absolute;
        background: #7cd3eb;
        border-radius: 50%;
        border: 1.5px solid #27506d;
        box-shadow: inset -1px -1px 0 0.5px #16638f,
          inset -1px -1px 0 1px #1985c0;
        box-sizing: border-box;
      }
    }
  }

  &:focus-visible {
    + label {
      outline: 1px dotted #000000;
    }
  }

  &:disabled {
    + label {
      opacity: 0.6;
    }
  }
}
